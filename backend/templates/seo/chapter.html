{% extends "seo/base.html" %}

{% block title %}Chapter {{ chapter.chapter_number }}: {{ chapter.english_title }}{% endblock %}

{% block description %}{{ chapter.summary[:160] if chapter.summary else 'Bhagavad Gita Chapter ' ~ chapter.chapter_number ~ ' - ' ~ chapter.english_title ~ ' with Sanskrit verses, translations, and commentary.' }}{% endblock %}

{% block canonical %}/verses/chapter/{{ chapter.chapter_number }}{% endblock %}

{% block og_type %}article{% endblock %}
{% block og_title %}Bhagavad Gita Chapter {{ chapter.chapter_number }}: {{ chapter.english_title }} | Geetanjali{% endblock %}
{% block og_description %}{{ chapter.summary[:200] if chapter.summary else 'Read all verses from Chapter ' ~ chapter.chapter_number }}{% endblock %}
{% block og_url %}/verses/chapter/{{ chapter.chapter_number }}{% endblock %}

{% block twitter_title %}Bhagavad Gita Chapter {{ chapter.chapter_number }}: {{ chapter.english_title }}{% endblock %}
{% block twitter_description %}{{ chapter.summary[:200] if chapter.summary else 'Read all verses from Chapter ' ~ chapter.chapter_number }}{% endblock %}

{% block jsonld %}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Chapter",
    "name": "{{ chapter.english_title | e }}",
    "position": {{ chapter.chapter_number }},
    "description": "{{ chapter.summary | e if chapter.summary else '' }}",
    "url": "https://geetanjaliapp.com/verses/chapter/{{ chapter.chapter_number }}",
    "isPartOf": {
        "@type": "Book",
        "name": "Bhagavad Gita",
        "author": { "@type": "Person", "name": "Vyasa" }
    },
    "hasPart": [
        {% for verse in verses %}
        {
            "@type": "Article",
            "name": "Verse {{ verse.chapter }}.{{ verse.verse }}",
            "position": {{ verse.verse }},
            "url": "https://geetanjaliapp.com/verses/{{ verse.canonical_id }}"
        }{% if not loop.last %},{% endif %}
        {% endfor %}
    ]
}
</script>
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
        {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://geetanjaliapp.com/"
        },
        {
            "@type": "ListItem",
            "position": 2,
            "name": "Verses",
            "item": "https://geetanjaliapp.com/verses"
        },
        {
            "@type": "ListItem",
            "position": 3,
            "name": "Chapter {{ chapter.chapter_number }}"
        }
    ]
}
</script>
{% endblock %}

{% block content %}
<article>
    <nav aria-label="Breadcrumb">
        <a href="/verses/">Verses</a> /
        Chapter {{ chapter.chapter_number }}
    </nav>

    <h1>Chapter {{ chapter.chapter_number }}: {{ chapter.english_title }}</h1>

    {% if chapter.summary %}
    <p class="chapter-description">{{ chapter.summary }}</p>
    {% endif %}

    <section aria-labelledby="verses">
        <h2 id="verses">Verses ({{ verses|length }})</h2>
        <ol class="verse-list">
            {% for verse in verses %}
            <li>
                <a href="/verses/{{ verse.canonical_id }}">
                    <strong>{{ verse.chapter }}.{{ verse.verse }}</strong>
                </a>
                <p class="sanskrit" lang="sa">{{ verse.sanskrit_devanagari[:100] }}{% if verse.sanskrit_devanagari|length > 100 %}...{% endif %}</p>
                {% set preview_text = verse.paraphrase_en if verse.paraphrase_en else verse.translation_en %}
                {% if preview_text %}
                <p class="preview">{{ preview_text[:150] }}{% if preview_text|length > 150 %}...{% endif %}</p>
                {% endif %}
            </li>
            {% endfor %}
        </ol>
    </section>

    <nav aria-label="Chapter navigation">
        {% if prev_chapter %}
        <a href="/verses/chapter/{{ prev_chapter.chapter_number }}">&larr; Chapter {{ prev_chapter.chapter_number }}: {{ prev_chapter.english_title }}</a>
        {% else %}
        <span></span>
        {% endif %}
        {% if next_chapter %}
        <a href="/verses/chapter/{{ next_chapter.chapter_number }}">Chapter {{ next_chapter.chapter_number }}: {{ next_chapter.english_title }} &rarr;</a>
        {% endif %}
    </nav>
</article>
{% endblock %}
